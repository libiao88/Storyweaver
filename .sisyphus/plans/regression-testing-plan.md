# StoryWeaver AI - 回归测试计划（部署后）

## 测试目标
对已成功部署到 https://storyweaver-2wy.pages.dev/ 的应用进行全面回归测试，发现并修复所有Bug。

## 部署信息
- **部署地址**: https://storyweaver-2wy.pages.dev/
- **部署平台**: Cloudflare Pages
- **部署时间**: 2026年2月16日

---

## 测试环境

### 客户端环境
- **浏览器**: Chrome 120+, Firefox 121+, Safari 17+
- **操作系统**: macOS, Windows, Linux, iOS, Android
- **网络**: 国内网络环境（Cloudflare北京/上海节点）

### 服务端环境
- **托管**: Cloudflare Pages
- **CDN**: Cloudflare全球网络
- **数据库**: Supabase (PostgreSQL)

---

## 回归测试用例

### 测试类别 1: 页面加载与渲染

#### TC-001: 首页加载
- **测试步骤**: 访问 https://storyweaver-2wy.pages.dev/
- **预期结果**: 
  - 页面在3秒内加载完成
  - 显示"智语拆解 StoryWeaver AI"标题
  - 所有资源（CSS/JS）正确加载
  - 无404错误

#### TC-002: 响应式设计
- **测试步骤**: 在不同屏幕尺寸下查看页面
- **预期结果**:
  - 桌面端（1920x1080）: 布局正常
  - 平板端（768x1024）: 布局正常
  - 移动端（375x667）: 布局正常

#### TC-003: Tab导航
- **测试步骤**: 点击各个Tab（上传、故事、地图、审计、API、分析、配置）
- **预期结果**:
  - 所有Tab可点击
  - Tab切换流畅
  - 当前Tab高亮显示

---

### 测试类别 2: 文件上传功能

#### TC-004: 文件选择
- **测试步骤**:
  1. 点击"选择文件"按钮
  2. 选择.docx文件
- **预期结果**: 
  - 文件选择对话框打开
  - 文件成功选中
  - 文件信息显示

#### TC-005: 文件格式验证
- **测试步骤**: 尝试上传不支持的格式（如.jpg）
- **预期结果**: 
  - 显示错误提示"不支持的文件格式"
  - 文件不被处理

#### TC-006: 文件大小验证
- **测试步骤**: 尝试上传超过20MB的文件
- **预期结果**: 
  - 显示错误提示"文件大小超过限制"
  - 文件不被处理

#### TC-007: 文档解析
- **测试步骤**:
  1. 上传有效的PRD文档（.docx或.md）
  2. 等待解析完成
- **预期结果**:
  - 显示处理进度
  - 成功解析文档
  - 自动生成用户故事
  - "故事"Tab变为可点击

---

### 测试类别 3: 用户故事功能

#### TC-008: 故事列表显示
- **测试步骤**: 
  1. 上传文档生成故事
  2. 点击"故事"Tab
- **预期结果**:
  - 故事列表正常显示
  - 显示故事标题、描述、优先级
  - 显示置信度和来源引用

#### TC-009: 故事筛选
- **测试步骤**: 使用筛选器筛选故事
- **预期结果**:
  - 可按模块筛选
  - 可按优先级筛选
  - 筛选结果正确

#### TC-010: 故事搜索
- **测试步骤**: 在搜索框输入关键词
- **预期结果**:
  - 实时搜索结果
  - 高亮匹配内容

#### TC-011: 故事编辑
- **测试步骤**:
  1. 点击故事的"编辑"按钮
  2. 修改故事内容
  3. 保存
- **预期结果**:
  - 编辑表单正常显示
  - 修改成功保存
  - 列表自动更新

#### TC-012: 故事删除
- **测试步骤**:
  1. 点击故事的"删除"按钮
  2. 确认删除
- **预期结果**:
  - 显示确认对话框
  - 故事成功删除
  - 列表自动更新

---

### 测试类别 4: 故事地图功能

#### TC-013: 地图显示
- **测试步骤**: 点击"地图"Tab
- **预期结果**:
  - 故事地图正常显示
  - 按模块和史诗分组显示

#### TC-014: 拖拽排序
- **测试步骤**: 拖拽故事卡片调整顺序
- **预期结果**:
  - 卡片可拖拽
  - 排序成功保存

---

### 测试类别 5: 导出功能

#### TC-015: CSV导出
- **测试步骤**:
  1. 选择多个故事
  2. 点击"导出CSV"按钮
- **预期结果**:
  - CSV文件成功下载
  - 文件内容格式正确

#### TC-016: Markdown导出
- **测试步骤**: 点击"导出Markdown"按钮
- **预期结果**:
  - Markdown内容复制到剪贴板
  - 格式正确，可直接使用

---

### 测试类别 6: LLM配置

#### TC-017: 配置页面加载
- **测试步骤**: 点击"配置"Tab
- **预期结果**:
  - 配置页面正常加载
  - 显示LLM配置选项
  - API Key输入框可用

#### TC-018: 模型选择
- **测试步骤**: 
  1. 选择不同的LLM模型
  2. 保存配置
- **预期结果**:
  - 模型列表正常显示
  - 选择成功保存

#### TC-019: API Key配置
- **测试步骤**:
  1. 输入API Key
  2. 点击"测试连接"
- **预期结果**:
  - 测试连接成功
  - 显示连接状态

---

### 测试类别 7: 数据持久化

#### TC-020: 页面刷新
- **测试步骤**:
  1. 上传文档生成故事
  2. 刷新页面
- **预期结果**:
  - 故事数据仍然保留
  - 数据从Supabase正确加载

#### TC-021: 跨会话数据
- **测试步骤**:
  1. 在一个浏览器窗口添加故事
  2. 在另一个窗口查看
- **预期结果**:
  - 数据同步正常
  - 实时更新（如果配置了Realtime）

---

### 测试类别 8: 错误处理

#### TC-022: 网络错误
- **测试步骤**: 断开网络后尝试操作
- **预期结果**:
  - 显示友好的错误提示
  - 应用不崩溃

#### TC-023: 无效API Key
- **测试步骤**: 输入错误的Supabase API Key
- **预期结果**:
  - 显示连接错误提示
  - 提示用户检查配置

---

## 测试执行计划

### 第一阶段：基础功能测试
- [ ] TC-001: 首页加载
- [ ] TC-002: 响应式设计
- [ ] TC-003: Tab导航
- [ ] TC-004: 文件选择
- [ ] TC-005: 文件格式验证
- [ ] TC-006: 文件大小验证

### 第二阶段：核心功能测试
- [ ] TC-007: 文档解析
- [ ] TC-008: 故事列表显示
- [ ] TC-009: 故事筛选
- [ ] TC-010: 故事搜索
- [ ] TC-011: 故事编辑
- [ ] TC-012: 故事删除

### 第三阶段：高级功能测试
- [ ] TC-013: 地图显示
- [ ] TC-014: 拖拽排序
- [ ] TC-015: CSV导出
- [ ] TC-016: Markdown导出

### 第四阶段：配置和数据测试
- [ ] TC-017: 配置页面加载
- [ ] TC-018: 模型选择
- [ ] TC-019: API Key配置
- [ ] TC-020: 页面刷新
- [ ] TC-021: 跨会话数据
- [ ] TC-022: 网络错误
- [ ] TC-023: 无效API Key

---

## 已知问题检查清单

基于TEST_REPORT.md中的历史问题，验证是否已修复：

- [ ] FileUpload组件正确使用DocumentParser
- [ ] Story接口类型统一
- [ ] 优先级值正确转换和显示

---

## 成功标准

- 所有测试用例通过率 ≥ 95%
- 无严重Bug（阻断性Bug数量为0）
- 轻微Bug ≤ 3个

---

## 下一步操作

1. 执行上述测试用例
2. 记录所有发现的Bug
3. 修复Bug
4. 重新测试验证修复
5. 更新测试报告
